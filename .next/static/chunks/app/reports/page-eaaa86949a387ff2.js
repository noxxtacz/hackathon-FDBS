(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{3014:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{type:t,message:r,onDismiss:a}=e;return(0,s.jsxs)("div",{role:"alert",className:"flex items-center justify-between rounded-xl border px-4 py-3 text-sm animate-slide-up ".concat("success"===t?"border-emerald-500/20 bg-emerald-500/10 text-emerald-400":"border-red-500/20 bg-red-500/10 text-red-400"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["success"===t?(0,s.jsx)("svg",{className:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:r})]}),a&&(0,s.jsx)("button",{onClick:a,className:"ml-4 opacity-60 hover:opacity-100 transition-opacity","aria-label":"Dismiss",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}},4927:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{title:t,subtitle:r}=e;return(0,s.jsxs)("header",{className:"mb-8 animate-fade-in",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-white sm:text-4xl",children:t}),r&&(0,s.jsx)("p",{className:"mt-2 text-base text-gray-400",children:r})]})}},7603:(e,t,r)=>{Promise.resolve().then(r.bind(r,8138))},8138:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),n=r(2619),i=r.n(n),o=r(4927),l=r(8391);let d={safe:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20 glow-cyan",suspicious:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20 glow-yellow",dangerous:"bg-red-500/10 text-red-400 border-red-500/20 glow-red"};function c(e){let{label:t}=e;return(0,s.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wider ".concat(d[t]),children:[(0,s.jsx)("span",{className:"h-1.5 w-1.5 rounded-full ".concat("safe"===t?"bg-emerald-400":"suspicious"===t?"bg-yellow-400":"bg-red-400")}),t]})}function x(e){var t;let{report:r,onVote:a}=e;return(0,s.jsxs)(l.A,{hover:!0,children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("h3",{className:"font-semibold text-white",children:r.threat_type}),(0,s.jsx)("p",{className:"mt-0.5 text-sm text-gray-500",children:r.governorate})]}),(0,s.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2",children:[(0,s.jsx)("span",{className:"rounded-lg bg-white/5 px-2 py-0.5 text-sm font-mono font-medium text-gray-300",children:r.risk_score}),(0,s.jsx)(c,{label:r.risk_label})]})]}),r.url_defanged&&(0,s.jsx)("p",{className:"mt-3 break-all rounded-lg bg-white/[0.03] px-3 py-1.5 font-mono text-xs text-gray-500",children:r.url_defanged}),r.description&&(0,s.jsx)("p",{className:"mt-3 text-sm leading-relaxed text-gray-400",children:r.description}),r.risk_reasons&&r.risk_reasons.length>0&&(0,s.jsx)("div",{className:"mt-3 flex flex-wrap gap-1.5",children:r.risk_reasons.slice(0,5).map((e,t)=>(0,s.jsx)("span",{className:"rounded-full border border-white/5 bg-white/[0.03] px-2.5 py-0.5 text-[10px] text-gray-500",children:e},t))}),r.solution&&(0,s.jsxs)("div",{className:"mt-3 rounded-xl border border-cyan-500/10 bg-cyan-500/5 px-4 py-2.5 text-sm text-cyan-300",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Solution:"})," ",r.solution]}),(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-gray-600",children:new Date(r.created_at).toLocaleDateString()}),(0,s.jsxs)("button",{onClick:()=>null==a?void 0:a(r.id),className:"flex items-center gap-1.5 rounded-lg px-2.5 py-1 text-xs font-medium transition ".concat(r.user_voted?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"border border-white/10 bg-white/5 text-gray-500 hover:text-gray-300 hover:bg-white/10"),children:[(0,s.jsx)("svg",{className:"h-3.5 w-3.5",fill:r.user_voted?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})}),null!=(t=r.vote_count)?t:0]})]})]})}var h=r(8354),u=r(3014);let m=["Tunis","Ariana","Ben Arous","Manouba","Nabeul","Zaghouan","Bizerte","B\xe9ja","Jendouba","Le Kef","Siliana","Sousse","Monastir","Mahdia","Sfax","Kairouan","Kasserine","Sidi Bouzid","Gab\xe8s","M\xe9denine","Tataouine","Gafsa","Tozeur","K\xe9bili"],p=["Phishing","Malware","Scam","Identity Theft","Social Engineering","Other"],g="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-gray-300 backdrop-blur focus:border-cyan-500/50 focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all";function b(){let[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)(""),[d,c]=(0,a.useState)(1),[b,f]=(0,a.useState)([]),[y,j]=(0,a.useState)(0),[v,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)(""),_=Math.max(1,Math.ceil(y/20)),S=(0,a.useCallback)(async()=>{w(!0),k("");try{var t,s,a;let n=new URLSearchParams;e&&n.set("governorate",e),r&&n.set("threat_type",r),n.set("page",String(d));let i=await fetch("/api/reports/list?".concat(n)),o=await i.json();if(!i.ok)return void k(null!=(t=o.error)?t:"Failed to load reports");f(null!=(s=o.reports)?s:[]),j(null!=(a=o.total)?a:0)}catch(e){k("Failed to load reports")}finally{w(!1)}},[e,r,d]);async function L(e){try{let r=await fetch("/api/reports/vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_id:e})});if(401===r.status)return void k("Login required to vote");let s=await r.json();if(!r.ok){var t;k(null!=(t=s.error)?t:"Vote failed");return}f(t=>t.map(t=>t.id===e?{...t,vote_count:s.vote_count,user_voted:s.voted}:t))}catch(e){k("Vote failed")}}return(0,a.useEffect)(()=>{S()},[S]),(0,a.useEffect)(()=>{c(1)},[e,r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{title:"Threat Reports",subtitle:"Browse crowdsourced threat intelligence from the AmanTN community."}),(0,s.jsxs)("div",{className:"mb-6 flex flex-wrap items-end gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"gov-filter",className:"mb-1.5 block text-xs font-medium uppercase tracking-wider text-gray-500",children:"Governorate"}),(0,s.jsxs)("select",{id:"gov-filter",value:e,onChange:e=>t(e.target.value),className:g,children:[(0,s.jsx)("option",{value:"",children:"All Governorates"}),m.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"type-filter",className:"mb-1.5 block text-xs font-medium uppercase tracking-wider text-gray-500",children:"Threat Type"}),(0,s.jsxs)("select",{id:"type-filter",value:r,onChange:e=>n(e.target.value),className:g,children:[(0,s.jsx)("option",{value:"",children:"All Types"}),p.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)(i(),{href:"/phishing",className:"ml-auto flex items-center gap-2 rounded-xl border border-cyan-500/20 bg-cyan-500/10 px-4 py-2 text-sm font-medium text-cyan-400 transition hover:bg-cyan-500/20",children:[(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Submit Report"]})]}),N&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(u.A,{type:"error",message:N,onDismiss:()=>k("")})}),v&&(0,s.jsx)(h.A,{}),!v&&0===b.length&&(0,s.jsxs)(l.A,{className:"flex flex-col items-center py-16 text-center",children:[(0,s.jsx)("svg",{className:"mb-4 h-12 w-12 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("p",{className:"text-gray-500",children:"No reports match your filters."}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-gray-600",children:["Be the first — ",(0,s.jsx)(i(),{href:"/phishing",className:"text-cyan-400 hover:text-cyan-300 transition-colors",children:"analyze a threat"})," and submit a report."]})]}),!v&&b.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-3 text-xs text-gray-500",children:["Showing ",(d-1)*20+1,"–",Math.min(20*d,y)," of ",y," reports"]}),(0,s.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:b.map(e=>(0,s.jsx)(x,{report:e,onVote:L},e.id))}),_>1&&(0,s.jsxs)("div",{className:"mt-8 flex items-center justify-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:d<=1,className:"rounded-lg border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-gray-400 transition hover:bg-white/10 disabled:cursor-not-allowed disabled:opacity-30",children:"Previous"}),Array.from({length:Math.min(_,5)},(e,t)=>{let r=d<=3?t+1:d+t-2;return r<1||r>_?null:(0,s.jsx)("button",{onClick:()=>c(r),className:"rounded-lg px-3 py-1.5 text-sm font-medium transition ".concat(r===d?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"border border-white/10 bg-white/5 text-gray-400 hover:bg-white/10"),children:r},r)}),(0,s.jsx)("button",{onClick:()=>c(e=>Math.min(_,e+1)),disabled:d>=_,className:"rounded-lg border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-gray-400 transition hover:bg-white/10 disabled:cursor-not-allowed disabled:opacity-30",children:"Next"})]})]})]})}},8354:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{size:t="md"}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",role:"status",children:[(0,s.jsx)("div",{className:"".concat("sm"===t?"h-5 w-5":"lg"===t?"h-12 w-12":"h-8 w-8"," animate-spin rounded-full border-2 border-white/10 border-t-cyan-400")}),(0,s.jsx)("span",{className:"sr-only",children:"Loading…"})]})}},8391:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{children:t,className:r="",hover:a=!1}=e;return(0,s.jsx)("div",{className:"rounded-2xl border border-white/[0.06] bg-white/[0.03] p-6 shadow-lg backdrop-blur-md transition-all duration-300 ".concat(a?"hover:scale-[1.02] hover:border-white/10 hover:bg-white/[0.05] hover:shadow-xl":""," ").concat(r),children:t})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=7603)),_N_E=e.O()}]);